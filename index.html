<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <script>
        const gameBoard = (function () {
            const rows = 3;
            const columns = 3;
            const board = [];
            //create 2d board array
            for (let i = 0; i < rows; i++) {
                board[i] = [];
                for (let j = 0; j < columns; j++) {
                    board[i].push(Cell());
                }
            }
            //display board array
            const getBoard = () => board;
            const printBoard = () => {
                const boardWithCellValues = board.map((row) => row.map((cell) => cell.getValue()))
                console.log(boardWithCellValues);
            };
            return {getBoard, printBoard};            
        })

        function Cell() {
            let value = 0;
            const placeMarker = (marker) => {
                if (value != 0) {
                    console.log("Invalid move");
                    return;
                } else {
                value = marker;
                }
            }
            const getValue = () => value;
            return {placeMarker, getValue};
            }

        function GameController(
            playerOneName = "Player One",
            playerTwoName = "Player Two"
        ) {
            const board = gameBoard();
            const players = [
                {
                    name: playerOneName,
                    token: 'X'
                },
                {
                    name: playerTwoName,
                    token: 'O'
                }
            ]

            let activePlayer = players[0];

            const switchPlayerTurn = () => {
                activePlayer = activePlayer === players[0] ? players[1] : players[0];
            }
            const getActivePlayer = () => activePlayer;

            const printNewRound = () => {
                board.printBoard();
                console.log(`${getActivePlayer().name}'s turn.`);
            };

            const flattenBoard = () => {
                let flatBoard = []
                board.getBoard().flat().forEach((el) => flatBoard.push(el.getValue()));
                return flatBoard;
            }

            let winState = ['X','X','X']

            const playRound = (row, column) => {
                board.getBoard()[row][column].placeMarker(activePlayer.token);
                if (flattenBoard().slice(0,3).join('') === "XXX"
                    || flattenBoard().slice(0,3).join('') === 'OOO'
                    || flattenBoard().slice(3,6).join('') === "XXX" 
                    || flattenBoard().slice(3,6).join('') === 'OOO'
                    || flattenBoard().slice(6).join('') === 'XXX'
                    || flattenBoard().slice(6).join('')=== 'OOO')  {
                        console.log(`${getActivePlayer().name} wins`);
                    }
                else {
                switchPlayerTurn();
                printNewRound();
               }
            };
            printNewRound();
            return{playRound, getActivePlayer, board, flattenBoard};
        }

        const game = GameController();
    </script>
</body>
</html>